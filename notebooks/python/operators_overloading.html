
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Перегрузка специальных методов и операторов &#8212; Практикум по компьютерным технологиям</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/my_css_rules.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Практические задания" href="exercises2.html" />
    <link rel="prev" title="Полиморфизм в python" href="polymorphism.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-EM33EZ6FLL"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-EM33EZ6FLL');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Практикум по компьютерным технологиям</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../docs/index.html">
                    Практикум по компьютерным технологиям на языке программирования python3
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №1
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="about_python.html">
   О
   <code class="docutils literal notranslate">
    <span class="pre">
     python
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../docs/getting_started.html">
   Установка
   <code class="docutils literal notranslate">
    <span class="pre">
     python
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../docs/python_as_calculator.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     Python
    </span>
   </code>
   в качестве калькулятора
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../docs/scripts.html">
   Скрипты
   <code class="docutils literal notranslate">
    <span class="pre">
     python
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jupyter.html">
   Блокноты.
   <code class="docutils literal notranslate">
    <span class="pre">
     Jupyter
    </span>
    <span class="pre">
     Notebooks
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numbers_and_lists.html">
   Основные типы объектов: числа и списки
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="if_for_range.html">
   Операторы потока управления
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../homework/1.html">
   Домашнее задание №1
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №2
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../docs/interpretability.html">
   Компилируемость vs Интерпретируемость
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dynamic_typing.html">
   Динамическая типизация
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type_annotations.html">
   Аннотация типов
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mutability.html">
   Изменяемые и неизменяемый типы объектов
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="garbage_collector.html">
   Создание и удаление объектов. Сборщик мусора
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sequences.html">
   Последовательности: списки, кортежи и строки
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../homework/2.html">
   Домашнее задание №2
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №3
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../docs/libs_pypi_conda.html">
   Сторонние библиотеки и пакетные менеджеры
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/numpy.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     NumPy
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/vectorization.html">
   Векторизация
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/slices.html">
   Срезы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/vector_product.html">
   Умножение векторов
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/logic.html">
   Логические операции
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/vectorization_example.html">
   Векторизация на примере вычисления статистик
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/random.html">
   Случайные числа
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/homework.html">
   Домашнее задание №3
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №4
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="dictionaries.html">
   Словари.
   <code class="docutils literal notranslate">
    <span class="pre">
     dict
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="functions.html">
   Функции
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="filesystem.html">
   Взаимодействие с файловой системой
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="files.html">
   Работа с файлами. Сериализация:
   <code class="docutils literal notranslate">
    <span class="pre">
     json
    </span>
   </code>
   и
   <code class="docutils literal notranslate">
    <span class="pre">
     pickle
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../visualization/libraries.html">
   Построение графиков и визуализация данных
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../visualization/matplotlib.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     Matplotlib
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../visualization/details.html">
   Настройка деталей графиков
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../visualization/matplotlib_animation.html">
   Анимация  в matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../visualization/homework.html">
   Домашнее задание №4
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №5
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/tables.html">
   Таблицы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/pandas.html">
   Библиотека
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/series.html">
   Столбцы в
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/dataframe.html">
   Таблицы
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/operations.html">
   Оперирование таблицами
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/datetime.html">
   Дата и время
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/covid19.html">
   Анализ данных о
   <code class="docutils literal notranslate">
    <span class="pre">
     COVID19
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/homework.html">
   Домашнее задание №5
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №6
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="list_comprehensions.html">
   Основы списковых включений
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="iterators.html">
   Итераторы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="generators.html">
   Генераторы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="decorators.html">
   Декораторы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../homework/6.html">
   Домашнее задание №6
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №7
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../scipy/scipy.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     SciPy
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scipy/linalg.html">
   Линейная алгебра
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scipy/interpolation_approx.html">
   Интерполяция и аппроксимация
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scipy/integration.html">
   Дифференцирование и интегрирование функций
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scipy/ODE.html">
   Решение ОДУ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scipy/optimization.html">
   Поиск минимума
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scipy/nonlinear_equations.html">
   Решение нелинейных уравнений
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../scipy/signal.html">
   Обработка сигналов
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №8
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="custom_classes.html">
   Пользовательские классы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inheritance.html">
   Наследование
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="polymorphism.html">
   Полиморфизм в python
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Перегрузка специальных методов и операторов
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exercises2.html">
   Практические задания
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №9
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="exceptions.html">
   Исключения
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="custom_exceptions.html">
   Пользовательские исключения
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="LBYL_vs_EAFP.html">
   Стратегии контроля ошибок
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №10
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/gui.html">
   Графический пользовательский интерфейс
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/basics.html">
   PySide. Основы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/event.html">
   События
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/slot_signal.html">
   Слоты и сигналы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/widgets.html">
   Виджеты и макеты
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/buttons.html">
   Кнопки
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/output.html">
   Вывод данных
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/input.html">
   Ввод данных
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/dialogs.html">
   Диалоговые окна
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/exercises.html">
   Практические задания
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  TBD
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="about_12_and_so_on.html">
   О последних лекциях
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../computer_vision/basics.html">
   Работа с изображениями
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../computer_vision/filters.html">
   Свёрточные операции
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../computer_vision/detection.html">
   Задача обнаружения
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../machine_learning/regression.html">
   Регрессия
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../machine_learning/classification.html">
   Классификация
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../machine_learning/neural_networks.html">
   Нейронный сети
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="python_scripts.html">
   Создание скриптов. Работа с IDE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="scripts_vs_modules.html">
   Скрипты и модули
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="argparse.html">
   Аргументы командной строки
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/FadeevLecturer/python_lectures/main?urlpath=tree/notebooks/python/operators_overloading.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/FadeevLecturer/python_lectures/blob/main/notebooks/python/operators_overloading.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/FadeevLecturer/python_lectures"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/FadeevLecturer/python_lectures/issues/new?title=Issue%20on%20page%20%2Fnotebooks/python/operators_overloading.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/FadeevLecturer/python_lectures/edit/main/notebooks/python/operators_overloading.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/notebooks/python/operators_overloading.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#str-repr">
   Приведение к строке.
   <code class="docutils literal notranslate">
    <span class="pre">
     __str__
    </span>
   </code>
   и
   <code class="docutils literal notranslate">
    <span class="pre">
     __repr__
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#call">
   Вызов объекта.
   <code class="docutils literal notranslate">
    <span class="pre">
     __call__
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iter">
   Итератор по объекту.
   <code class="docutils literal notranslate">
    <span class="pre">
     __iter__
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   Перегрузка операторов
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Доступные операторы
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Арифметические операторы
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id5">
         Операнд справа
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id6">
         Версия оператора на месте
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id7">
         Пример
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       Операторы сравнения
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       Побитовые операторы
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#container-operators">
       Операторы контейнеров
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       Операторы последовательностей
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Перегрузка специальных методов и операторов</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#str-repr">
   Приведение к строке.
   <code class="docutils literal notranslate">
    <span class="pre">
     __str__
    </span>
   </code>
   и
   <code class="docutils literal notranslate">
    <span class="pre">
     __repr__
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#call">
   Вызов объекта.
   <code class="docutils literal notranslate">
    <span class="pre">
     __call__
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iter">
   Итератор по объекту.
   <code class="docutils literal notranslate">
    <span class="pre">
     __iter__
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   Перегрузка операторов
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Доступные операторы
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Арифметические операторы
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id5">
         Операнд справа
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id6">
         Версия оператора на месте
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id7">
         Пример
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       Операторы сравнения
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       Побитовые операторы
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#container-operators">
       Операторы контейнеров
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       Операторы последовательностей
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>Перегрузка специальных методов и операторов<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h1>
<p>Перегрузка специальных методов позволяет достичь многих аспектов полиморфизма.</p>
<section id="str-repr">
<h2>Приведение к строке. <code class="docutils literal notranslate"><span class="pre">__str__</span></code> и <code class="docutils literal notranslate"><span class="pre">__repr__</span></code><a class="headerlink" href="#str-repr" title="Permalink to this headline">#</a></h2>
<p>Если попробовать распечатать экземпляр пользовательского класса, то вы получите нечто не очень содержательное.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from numbers import Number

class Quaternion(Number):
    def __init__(self, a, b, c, d):
        self.a = a
        self.b = b
        self.c = c
        self.d = d

q = Quaternion(1, 2, 3, 4)
print(q)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;__main__.Quaternion object at 0x00000228CEFE1FD0&gt;
</pre></div>
</div>
</div>
</div>
<p>При попытке распечатать экземпляр класса <code class="docutils literal notranslate"><span class="pre">Quaternion</span></code> мы получили сообщение, из которого никак нельзя узнать значение атрибутов объекта.</p>
<p>Этот класс в примере реализует тип <a class="reference external" href="https://ru.wikipedia.org/wiki/%D0%9A%D0%B2%D0%B0%D1%82%D0%B5%D1%80%D0%BD%D0%B8%D0%BE%D0%BD">кватернионов</a>. Кватернион <span class="math notranslate nohighlight">\(q\)</span> можно задать четырьмя действительными числами <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span> и <span class="math notranslate nohighlight">\(d\)</span>. Тогда он определяется как сумма</p>
<div class="math notranslate nohighlight">
\[
    q = a + b i + c j + d k.
\]</div>
<p>Сделаем так, чтобы функцией <code class="docutils literal notranslate"><span class="pre">print</span></code> на экран выводилось представление кватерниона в такой форме. Для это необходимо объявить специальный метод <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#object.__str__">__str__</a>, который отвечает за приведение объекта к строке (встроенная функция <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> сначала пытается вызвать этот метод).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>class Quaternion(Number):
    def __init__(self, a, b, c, d):
        self.a = a
        self.b = b
        self.c = c
        self.d = d

    def __str__(self):
        return f&quot;{self.a} + {self.b}i + {self.c}j + {self.d}k&quot;

q = Quaternion(1, 2, 3, 4)
print(q)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 + 2i + 3j + 4k
</pre></div>
</div>
</div>
</div>
<p>Есть также похожий метод <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#object.__repr__">__repr__</a> (и соответствующая встроенная функция <a class="reference external" href="https://docs.python.org/3/library/functions.html#repr">repr</a>), который тоже должен возвращать строку. Разница между <code class="docutils literal notranslate"><span class="pre">__str__</span></code> и <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> примерное следующая.</p>
<ul class="simple">
<li><p>Метод <code class="docutils literal notranslate"><span class="pre">__str__</span></code> должен возвращать читабельную для человека строку. Такой метод вызывается функцией <code class="docutils literal notranslate"><span class="pre">print</span></code>.</p></li>
<li><p>Метод <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> должен возвращать строку, из которой можно было бы восстановить объект. Такой метод может быть полезен для отладки.</p></li>
</ul>
<p>Для примера реализуем метод <code class="docutils literal notranslate"><span class="pre">__repr__</span></code>, вычисление результата которого воссоздаст исходный объект.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>class Quaternion(Number):
    def __init__(self, a, b, c, d):
        self.a = a
        self.b = b
        self.c = c
        self.d = d

    def __str__(self):
        return f&quot;{self.a} + {self.b}i + {self.c}j + {self.d}k&quot;
    
    def __repr__(self):
        return f&quot;Quaternion(a={self.a}, b={self.b}, c={self.c}, d={self.d})&quot;

q = Quaternion(1, 2, 3, 4)
representation = repr(q)
print(representation)

q_copy = eval(representation)
print(q_copy)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Quaternion(a=1, b=2, c=3, d=4)
1 + 2i + 3j + 4k
</pre></div>
</div>
</div>
</div>
</section>
<section id="call">
<span id="call-obj"></span><h2>Вызов объекта. <code class="docutils literal notranslate"><span class="pre">__call__</span></code><a class="headerlink" href="#call" title="Permalink to this headline">#</a></h2>
<p>Определив специальный метод <code class="docutils literal notranslate"><span class="pre">__call__</span></code>, можно имитировать функции.</p>
<p>В качестве примера реализуем класс, который позволит вычислять композицию функций одной переменной. Напомним, что композицией двух функций <span class="math notranslate nohighlight">\(f:\mathbb{R} \to \mathbb{R}\)</span> и <span class="math notranslate nohighlight">\(g:\mathbb{r} \to \mathbb{R}\)</span> называется функция <span class="math notranslate nohighlight">\(h = f \circ g:\mathbb{R} \to \mathbb{R}\)</span>, значение которой <span class="math notranslate nohighlight">\(h(x) = f(g(x))\)</span> для <span class="math notranslate nohighlight">\(\forall x \in \mathbb{R}\)</span>.</p>
<p>Реализация такого класса может выглядеть как-нибудь вот так.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from collections.abc import Callable
import math

class Composition(Callable):
    def __init__(self, f, g):
        self.f = f
        self.g = g

    def __call__(self, x):
        return self.f(self.g(x))

f = abs
g = math.sin
h = Composition(f, g)
print(h(-math.pi / 2.))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Конструктор класса <code class="docutils literal notranslate"><span class="pre">Composition</span></code> принимает на вход две функции (или вызываемых объекта), запоминает их в атрибуты <code class="docutils literal notranslate"><span class="pre">f</span></code> и <code class="docutils literal notranslate"><span class="pre">g</span></code>. При вызове объекта (пара круглых скобок после имени объекта), вызывается метод <code class="docutils literal notranslate"><span class="pre">__call__</span></code>, который в данном случае возвращает результат вычисления <code class="docutils literal notranslate"><span class="pre">f(g(x))</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
from matplotlib import pyplot as plt
plt.rc(&#39;font&#39;, size=18)


X = np.linspace(0, 2*np.pi)
Y1 = [h(x) for x in X]
Y2 = [f(g(x)) for x in X]

fig, ax = plt.subplots(figsize=(10, 6))
ax.plot(X, Y1, &quot;r.&quot;, label=&quot;h(x)&quot;)
ax.plot(X, Y2, label=&quot;f(g(x))&quot;)
ax.set_xlabel(&quot;x&quot;)
ax.set_ylabel(&quot;y&quot;)
ax.legend()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1deae7afe50&gt;
</pre></div>
</div>
<img alt="../../_images/operators_overloading_10_1.png" src="../../_images/operators_overloading_10_1.png" />
</div>
</div>
</section>
<section id="iter">
<h2>Итератор по объекту. <code class="docutils literal notranslate"><span class="pre">__iter__</span></code><a class="headerlink" href="#iter" title="Permalink to this headline">#</a></h2>
<p>Если ваш элемент класс является контейнером, то может потребоваться возможность пробежаться по его элементам. Для этого необходимо, чтобы встроенная функция <a class="reference external" href="https://docs.python.org/3/library/functions.html#iter">iter</a> возвращала итератор по этому объекту. Чтобы это работало у пользовательского класса, необходимо или реализовать оператор извлечения элемента по индексу (см. <a class="reference internal" href="#container-operators"><span class="std std-ref">Операторы контейнеров</span></a>) или реализовать метод <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>, чтобы он возвращал итератор по нему.</p>
<p><a class="reference external" href="https://docs.python.org/3/glossary.html#term-iterator">Итератор</a> в свою очередь должен поддерживать метод <code class="docutils literal notranslate"><span class="pre">__next__</span></code> и метод <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>. Последний необходим для того, чтобы итератор сам по себе можно было использовать в цикле <code class="docutils literal notranslate"><span class="pre">for</span></code> (выражение <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">x</span> <span class="pre">in</span> <span class="pre">iterable</span></code> первым шагом вызывает <code class="docutils literal notranslate"><span class="pre">iter(iterable)</span></code>) и в схожих контекстах.</p>
<p>В ряде случаев проще всего реализовать метод <code class="docutils literal notranslate"><span class="pre">__iter__</span></code> в виде генератора, т.к. они автоматически поддерживают и метод <code class="docutils literal notranslate"><span class="pre">__next__</span></code> и метод <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>. В качестве примера рассмотрим класс векторов трехмерного пространства и предположим, что мы хотим уметь итерироваться по его координатам.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from collections import abc

class Vector3D(abc.Iterable):
    def __init__(self, x, y, z):
        self.x = x
        self.y = y
        self.z = z
    
    def __iter__(self):
        yield self.x
        yield self.y
        yield self.z

v = Vector3D(42, 3, 13)

for coordinate in v:
    print(coordinate, end=&quot; &quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>42 3 13 
</pre></div>
</div>
</div>
</div>
<p>Как видим, метод <code class="docutils literal notranslate"><span class="pre">__iter__</span></code> является функцией-генератором. Объект генератора результата вызова <code class="docutils literal notranslate"><span class="pre">__init__()</span></code> по очереди возвращает координаты <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> и <code class="docutils literal notranslate"><span class="pre">z</span></code>.</p>
<p>Теперь, в качестве альтернативы реализуем класс итератора <code class="docutils literal notranslate"><span class="pre">Iterator</span></code> по объектам <code class="docutils literal notranslate"><span class="pre">Vector3D</span></code> в явном виде. Теперь метод <code class="docutils literal notranslate"><span class="pre">Vector3D.__iter__</span></code> возвращает экземпляр класса <code class="docutils literal notranslate"><span class="pre">Iterator</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from collections import abc 

class Vector3D(abc.Iterable):
    def __init__(self, x, y, z):
        self.x = x
        self.y = y
        self.z = z
    
    def __iter__(self):
        return Vector3D.Iterator(self)

    class Iterator(abc.Iterator):
        attributes = &quot;xyz&quot;
        def __init__(self, vector):
            print(&quot;Создан итератор.&quot;)
            self.vector = vector
            self.current = 0

        def __iter__(self):
            return self
        
        def __next__(self):
            try:
                current_attribute = self.attributes[self.current]
            except IndexError:
                raise StopIteration
            
            self.current += 1
            return getattr(self.vector, current_attribute)

v = Vector3D(42, 3, 13)
 
for coordinate in v:
    print(coordinate, end=&quot; &quot;)        
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Создан итератор.
42 3 13 
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>В целях инкапсуляции класс итератора объявлен прямо в теле исходного класса;</p></li>
<li><p>Метод <code class="docutils literal notranslate"><span class="pre">__init__</span></code> этого класса принимает на вход экземпляр класса, запоминает значения атрибутов класса и устанавливает значение счетчик равным нулю. Этот счетчик затем используется, чтобы запомнить атрибут, на котором мы остановились в методе <code class="docutils literal notranslate"><span class="pre">next</span></code>;</p></li>
<li><p>Метод <code class="docutils literal notranslate"><span class="pre">__next__</span></code> возвращает значение следующего атрибута, имя которого получается индексацией из строки <code class="docutils literal notranslate"><span class="pre">attributes</span></code>. Когда символы этой строки заканчиваются, то происходит обращение к символу строки за её пределами, что приводит к возбуждению исключения <code class="docutils literal notranslate"><span class="pre">IndexError</span></code>. Это исключение перехватывается и вместо него возбуждается <code class="docutils literal notranslate"><span class="pre">StopIteration</span></code>, что сигнализирует вызывающему коду, что итератор исчерпался;</p></li>
<li><p>Метод <code class="docutils literal notranslate"><span class="pre">__iter__</span></code> итератора возвращает ссылку на себя, что позволяет использовать его самого в цикле <code class="docutils literal notranslate"><span class="pre">for</span></code>, как в примере ниже.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>it = iter(v)
print(it)

for coordinate in it:
    print(coordinate, end=&quot; &quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Создан итератор.
&lt;__main__.Vector3D.Iterator object at 0x00000228CE202730&gt;
42 3 13 
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h2>Перегрузка операторов<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<section id="id3">
<h3>Доступные операторы<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<p>Как и во многих других языках программирования, в <code class="docutils literal notranslate"><span class="pre">python</span></code> можно перегружать действие операторов на пользовательские объекты. Все операторы в <code class="docutils literal notranslate"><span class="pre">python</span></code> могут быть представлены в форме специальных методов. Например, метод <code class="docutils literal notranslate"><span class="pre">__add__</span></code> из этого модуля соответствует оператору <code class="docutils literal notranslate"><span class="pre">+</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = 42
y = 7

print(x.__add__(y))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>49
</pre></div>
</div>
</div>
</div>
<p>Для всех остальных арифметических операторов, есть свои функции и, забегая вперед, специальные методы с такими же именами, но окруженные двойными нижними подчеркиваниями.</p>
<section id="id4">
<h4>Арифметические операторы<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h4>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Арифметическое действие</p></th>
<th class="head"><p>Операторная форма</p></th>
<th class="head"><p>Метод</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Сложение</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__add__(b)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Вычитание</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">-</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__sub__(b)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Умножение</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">*</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__mul__(b)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Обычное деление</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">/</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__truediv__(a,</span> <span class="pre">b)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Целочисленное деление</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">//</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__floordiv__(b)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Остаток от деления</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">%</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__mod__(b)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Возведение в степень</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">**</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__pow__(b)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Матричное умножение</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&#64;</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__matmul__(b)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Положительный</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">+a</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__pos__()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Арифметическое отрицание</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-a</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__neg__()</span></code></p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Для каждого бинарного оператора существует аналог с префиксом <code class="docutils literal notranslate"><span class="pre">r</span></code> (например, <code class="docutils literal notranslate"><span class="pre">__radd__</span></code>) и аналог с префиксом <code class="docutils literal notranslate"><span class="pre">i</span></code> (например, <code class="docutils literal notranslate"><span class="pre">__iadd__</span></code>).</p>
</div>
<section id="id5">
<h5>Операнд справа<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h5>
<p>Если встречается выражение <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code>, то сначала <code class="docutils literal notranslate"><span class="pre">python</span></code> пробует вызвать <code class="docutils literal notranslate"><span class="pre">a.__add__(b)</span></code>. Если такой метод у объекта <code class="docutils literal notranslate"><span class="pre">a</span></code> не определен или этот метод возвращает <a class="reference external" href="https://docs.python.org/3/library/constants.html#NotImplemented">NotImplemented</a>, то <code class="docutils literal notranslate"><span class="pre">python</span></code> пробует вызвать <code class="docutils literal notranslate"><span class="pre">b.__radd__(a)</span></code>. Если и он не определен или возвращает <code class="docutils literal notranslate"><span class="pre">NotImplemented</span></code>, то <code class="docutils literal notranslate"><span class="pre">python</span></code> возбуждает ошибку <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>.</p>
</section>
<section id="id6">
<h5>Версия оператора на месте<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h5>
<p>Если встречается выражение <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+=</span> <span class="pre">b</span></code>, то сначала <code class="docutils literal notranslate"><span class="pre">python</span></code> попытается вызвать <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">a.__iadd__(b)</span></code>. Если такой метод у объекта <code class="docutils literal notranslate"><span class="pre">a</span></code> не определен, то <code class="docutils literal notranslate"><span class="pre">python</span></code> пробует свести выражение <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+=</span> <span class="pre">b</span></code> к выражению <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code>, т.е. <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">a.__add__(b)</span></code>. Далее процедура следует алгоритму, описанному в предыдущем абзаце.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Методы на месте должны возвращать ссылку на какой-то объект. Для неизменяемых типов это обычно ссылка на новый объект, для изменяемых — ссылка на исходный объект (<code class="docutils literal notranslate"><span class="pre">self</span></code>, если вы следуете соглашениям).</p>
</div>
</section>
<section id="id7">
<h5>Пример<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h5>
<p>В качестве самого простого примера реализуем свой тип “изменяемых” целых чисел, который будет поддерживать все формы оператора умножения.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from numbers import Number

class MyMutableInt(Number):
    def __init__(self, value):
        if not isinstance(value, int):
            raise TypeError(&quot;Допускаются только целые числа&quot;)
        self.value = value

    def __str__(self):
        return str(self.value)

    def __repr__(self):
        return f&quot;MyMutableInt(value={self.value})&quot;

    def __mul__(self, other):
        print(f&quot;Умножение {self} на {other}. Объект слева.&quot;)
        if(isinstance(other, int)):
            return MyMutableInt(self.value * other)
        if(isinstance(other, MyMutableInt)):
            return MyMutableInt(self.value * other.value)  
        return NotImplemented
        
    def __rmul__(self, other):
        print(f&quot;Умножение {other} на {self}. Объект справа.&quot;)
        return self * other

    def __imul__(self, other):
        print(f&quot;Умножение {self} на {other} на месте&quot;)
        if(isinstance(other, int)):
            self.value *= other
            return self
        if(isinstance(other, MyMutableInt)):
            self.value *= other.value
            return self  
        return NotImplemented    



print(MyMutableInt(3) * MyMutableInt(7))
print(MyMutableInt(42) * 13)
print(42 * MyMutableInt(13))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Умножение 3 на 7. Объект слева.
21
Умножение 42 на 13. Объект слева.
546
Умножение 42 на 13. Объект справа.
Умножение 13 на 42. Объект слева.
546
</pre></div>
</div>
</div>
</div>
<p>Умножать экземпляры этого класса на встроенные целые числа можно в любом порядке за счет реализации метода <code class="docutils literal notranslate"><span class="pre">__rmul__</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Важно обратить внимание, что не все арифметические операции коммутативны, а значит в некоторых из них нельзя в методе с префиксом <code class="docutils literal notranslate"><span class="pre">r</span></code> просто поменять операнды местами.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = MyMutableInt(3)
print(f&quot;Значение {x} по адресу {id(x)}&quot;)
x *= 7
print(f&quot;Значение {x} по адресу {id(x)}&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Значение 3 по адресу 2017574962800
Умножение 3 на 7 на месте
Значение 21 по адресу 2017574962800
</pre></div>
</div>
</div>
</div>
<p>Умножать на месте можно за счет реализации метода <code class="docutils literal notranslate"><span class="pre">__imul__</span></code>.</p>
<p>Все остальные операторы перегружаются аналогично.</p>
</section>
</section>
<section id="id8">
<h4>Операторы сравнения<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h4>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Сравнение на</p></th>
<th class="head"><p>Операторная форма</p></th>
<th class="head"><p>Метод</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Равенство</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">==</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__eq__(b)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Неравенство</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">!=</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__ne__(b)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Меньше</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&lt;</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__lt__(b)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Меньше или равно</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&lt;=</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__le__(b)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Больше или равно</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&gt;=</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__ge__(b)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Больше</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&gt;</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__gt__(b)</span></code></p></td>
</tr>
</tbody>
</table>
<p>Все эти методы должны возвращать, <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">False</span></code> (или приводимое к ним значение), если сравнение произошло успешно, и <code class="docutils literal notranslate"><span class="pre">NotImplemented</span></code>, если сравнение с объектом такого типа не предусмотренно. В отличие от арифметических операций, не существует отраженных версий операторов сравнения с префиксом <code class="docutils literal notranslate"><span class="pre">r</span></code>. Вместо этого <code class="docutils literal notranslate"><span class="pre">a.__gt__(b)</span></code> (<code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&gt;</span> <span class="pre">b</span></code>) является отражением <code class="docutils literal notranslate"><span class="pre">b.__lt__(a)</span></code> (<code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">&lt;</span> <span class="pre">a</span></code>) и т.п. Возвращенное значение <code class="docutils literal notranslate"><span class="pre">NotImplemented</span></code> приведет к вызову отраженного оператора.</p>
<p>Метод <code class="docutils literal notranslate"><span class="pre">__eq__</span></code> по умолчанию эквивалентен <code class="docutils literal notranslate"><span class="pre">is</span></code>, т.е. сравнение двух экземпляров всегда даёт <code class="docutils literal notranslate"><span class="pre">False</span></code>, если только это не один и тот же объект.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Если множество всех экземпляров класса является <a class="reference external" href="https://ru.wikipedia.org/wiki/%D0%9B%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D0%BE_%D1%83%D0%BF%D0%BE%D1%80%D1%8F%D0%B4%D0%BE%D1%87%D0%B5%D0%BD%D0%BD%D0%BE%D0%B5_%D0%BC%D0%BD%D0%BE%D0%B6%D0%B5%D1%81%D1%82%D0%B2%D0%BE">линейно упорядоченным</a>, то можно воспользоваться декоратором <a class="reference external" href="https://docs.python.org/3/library/functools.html#functools.total_ordering">total_ordering</a> из модуля <a class="reference external" href="https://docs.python.org/3/library/functools.html">functools</a>: необходимо определить лишь метод для <code class="docutils literal notranslate"><span class="pre">==</span></code> и один из операторов <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code> и <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, а остальные сгенерируются декоратором.</p>
</div>
<p>Множество целых чисел является линейно упорядоченным. Дополним пример с <code class="docutils literal notranslate"><span class="pre">MyMutableInt</span></code> операторами сравнения <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> и <code class="docutils literal notranslate"><span class="pre">==</span></code>, а остальные позволим сгенерировать декоратору <code class="docutils literal notranslate"><span class="pre">total_ordering</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from numbers import Number
from functools import total_ordering

@total_ordering
class MyMutableInt(Number):
    def __init__(self, value):
        if not isinstance(value, int):
            raise TypeError(&quot;Допускаются только целые числа&quot;)
        self.value = value

    def __str__(self):
        return str(self.value)

    def __repr__(self):
        return f&quot;MyMutableInt(value={self.value})&quot;

    def __lt__(self, other):
        if isinstance(other, int):
            return self.value &lt; other
        if isinstance(other, MyMutableInt):
            return self.value &lt; other.value
        return NotImplemented

    def __eq__(self, other):
        if isinstance(other, int):
            return self.value == other
        if isinstance(other, MyMutableInt):
            return self.value == other.value
        return NotImplemented

print(MyMutableInt(3) &lt; MyMutableInt(7), MyMutableInt(3) &lt;= 7)
print(MyMutableInt(42) &gt; 13, MyMutableInt(42) &gt;= 13)
print(42 == MyMutableInt(13))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True True
True True
False
</pre></div>
</div>
</div>
</div>
<p>Все операторы сравнения работают. В качестве бонуса мы теперь можем сортировать списки чисел типа <code class="docutils literal notranslate"><span class="pre">MyMutableInt</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from random import randint

L = [MyMutableInt(randint(-10, 10)) for _ in range(5)]

print(L)
print(sorted(L))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[MyMutableInt(value=6), MyMutableInt(value=-1), MyMutableInt(value=-4), MyMutableInt(value=5), MyMutableInt(value=10)]
[MyMutableInt(value=-4), MyMutableInt(value=-1), MyMutableInt(value=5), MyMutableInt(value=6), MyMutableInt(value=10)]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id9">
<h4>Побитовые операторы<a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h4>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Операция</p></th>
<th class="head"><p>Операторная форма</p></th>
<th class="head"><p>Метод</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Побитовое “и”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&amp;</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__and__(b)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Побитовое “или”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">|</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__or__(b)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Побитовое “исключающее или”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">^</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__xor__(b)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Побитовое “не”</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">~</span> <span class="pre">a</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__invert__()</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Битовый сдвиг влево</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&lt;&lt;</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__lshift__(b)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Битовый сдвиг вправо</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&gt;&gt;</span> <span class="pre">b</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.__rshift__(b)</span></code></p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Для всех бинарных побитовых операторов справедливы все те же замечания, что и для арифметических операторов, т.е. есть аналогичные методы с префиксами <code class="docutils literal notranslate"><span class="pre">r</span></code> и <code class="docutils literal notranslate"><span class="pre">i</span></code> для выполнения операций, когда объект стоит справа от оператора, и для выполнения операций на месте.</p>
</div>
</section>
<section id="container-operators">
<span id="id10"></span><h4>Операторы контейнеров<a class="headerlink" href="#container-operators" title="Permalink to this headline">#</a></h4>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Операция</p></th>
<th class="head"><p>Операторная форма</p></th>
<th class="head"><p>Метод</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Проверка принадлежности</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">obj</span> <span class="pre">in</span> <span class="pre">collection</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">collection.__contains__(obj)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Обращение по индексу</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">obj[k]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">obj.__getitem__(k)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Присваивание по индексу</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">obj[k]</span> <span class="pre">=</span> <span class="pre">v</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">obj.__setitem__(k,</span> <span class="pre">v)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Удаление по индексу</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">obj[k]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">obj.__delitem__(k)</span></code></p></td>
</tr>
</tbody>
</table>
<p>Метод <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> мы неявно вызывали уже много раз. У списков и кортежей этот метод позволяет получить элемент по индексу, у строк получить символ. У словарей он позволяет получить значение по ключу. Также этот метод реализован у массивов <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> и у таблиц <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p>
<p>В качестве примера рассмотрим ещё одну возможную реализацию диапазона действительных чисел. Пусть конструктор принимает параметры <code class="docutils literal notranslate"><span class="pre">start</span></code>, <code class="docutils literal notranslate"><span class="pre">stop</span></code> и <code class="docutils literal notranslate"><span class="pre">step</span></code>, а метод <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> возвращает <code class="docutils literal notranslate"><span class="pre">k</span></code>-й элемент последовательности, который вычисляется по формуле</p>
<div class="math notranslate nohighlight">
\[
    \text{frange}[k] =  \text{start} + \text{step} * k,
\]</div>
<p>где <span class="math notranslate nohighlight">\(k\)</span> в диапазоне от <span class="math notranslate nohighlight">\(0\)</span> до длинны последовательности <span class="math notranslate nohighlight">\(\text{length}\)</span>, которая вычисляется по формуле</p>
<div class="math notranslate nohighlight">
\[
     \text{length} = \left\lfloor\dfrac{\text{stop} - \text{start}}{\text{start}}\right\rfloor + 1.
\]</div>
<p>Вынесем вычисление <span class="math notranslate nohighlight">\(k\)</span>-го элемента последовательности в отдельный не публичный метод и предусмотрим индексацию отрицательными индексами.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from collections.abc import Sequence
from math import floor

class FloatRange(Sequence):
    def __init__(self, start, stop, step=1.0):
        self.start = start
        self.stop = stop
        if step == 0:
            raise ValueError(&quot;Параметр step не может быть равен нулю&quot;)
        self.step = step
        
        self.length = floor((self.stop - self.start) / self.step) + 1
    
    def __str__(self):
        return f&quot;range({self.start}, {self.stop}, {self.step})&quot;

    def __repr__(self):
         return f&quot;FloatRange(start={self.start}, stop={self.stop}, step={self.step})&quot;   

    def __len__(self):
        return self.length

    def _kth_value(self, k):
        return self.start + k * self.step
        
    def __getitem__(self, k):
        if isinstance(k, int):
            if k &lt; -self.length or k &gt;= self.length:
                raise IndexError(&quot;Индекс за пределами диапазона&quot;)
            k =  k + self.length if k &lt; 0 else k
            return self._kth_value(k)
        raise TypeError(&quot;Индексация возможна только целым числом&quot;)

r = FloatRange(0., 3, 0.5)
for i in range(-r.length, r.length):
    print(r[i], end=&quot; &quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0 0.5 1.0 1.5 2.0 2.5 3.0 0.0 0.5 1.0 1.5 2.0 2.5 3.0 
</pre></div>
</div>
</div>
</div>
<p>Класс <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">collections.abc.Sequence</a> — абстрактный базовый класс с абстрактными методами <code class="docutils literal notranslate"><span class="pre">__len__</span></code> и <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>, т.е. то, что мы наследовали от него, принуждает нас реализовать не только метод <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>, но и метод <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#object.__len__">__len__</a>. Зато теперь для объектов этого класса автоматически генерируется ряд методов, такие как <code class="docutils literal notranslate"><span class="pre">__contains__</span></code> и <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>. Такие сгенерированные методы называют <a class="reference external" href="https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%B8%D0%BC%D0%B5%D1%81%D1%8C_(%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5)">примесями</a> (<a class="reference external" href="https://en.wikipedia.org/wiki/Mixin">mixin</a>).</p>
<p>Это значит, что мы можем итерировать по объектам <code class="docutils literal notranslate"><span class="pre">FloatRange</span></code>, не реализуя специальный метод <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>for x in FloatRange(3.0, 0.0, -0.5):
    print(x, end=&quot; &quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0 2.5 2.0 1.5 1.0 0.5 0.0 
</pre></div>
</div>
</div>
</div>
<p>А так же проверять элемент на принадлежность диапазону.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>r = FloatRange(0., 3, 0.5)

print(1.5 in r)
print(2.71 in r)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
False
</pre></div>
</div>
</div>
</div>
<p>Но если попробовать получить срезу, то получиться ошибка, т.к. мы это не предусмотрели в методе <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>try:
    r[1:3]
except TypeError as msg:
    print(msg)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id11">
<h4>Операторы последовательностей<a class="headerlink" href="#id11" title="Permalink to this headline">#</a></h4>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Операция</p></th>
<th class="head"><p>Операторная форма</p></th>
<th class="head"><p>Метод</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Обращение по срезу</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">seq[i:j]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">seq.__getitem__(slice(i,</span> <span class="pre">j))</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Присваивание по срезу</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">seq[i:j]</span> <span class="pre">=</span> <span class="pre">values</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">seq.__setitem__(slice(i,</span> <span class="pre">j),</span> <span class="pre">values)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Удаление по срезу</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">seq[i:j]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">seq.__detitem__(slice(i,</span> <span class="pre">j)</span></code></p></td>
</tr>
</tbody>
</table>
<p>Чтобы можно было получать срез, необходимо предусмотреть ситуацию, когда в функцию <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> передано не целое число, а объект <a class="reference external" href="https://docs.python.org/3/library/functions.html#slice">slice</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Выражение <code class="docutils literal notranslate"><span class="pre">a[start:stop:step]</span></code> эквивалентно <code class="docutils literal notranslate"><span class="pre">a[slice(start,</span> <span class="pre">stop,</span> <span class="pre">step)]</span></code>.</p>
</div>
<p>Расширим предыдущий пример функциональностью среза.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from collections.abc import Sequence
from math import floor

class FloatRange(Sequence):
    def __init__(self, start, stop, step=1.0):
        self.start = start
        self.stop = stop
        if step == 0:
            raise ValueError(&quot;Параметр step не может быть равен нулю.&quot;)
        self.step = step
        
        self.length = floor((self.stop - self.start) / self.step) + 1
    
    def __str__(self):
        return f&quot;range({self.start}, {self.stop}, {self.step})&quot;

    def __repr__(self):
         return f&quot;FloatRange(start={self.start}, stop={self.stop}, step={self.step})&quot;  

    def __len__(self):
        return self.length

    def _kth_value(self, k):
        return self.start + k * self.step
        
    def __getitem__(self, k):
        if isinstance(k, int):
            if k &lt; -self.length or k &gt;= self.length:
                raise IndexError(&quot;Индекс за пределами диапазона&quot;)
            k =  k + self.length if k &lt; 0 else k
            return self._kth_value(k)
            
        if isinstance(k, slice):
            slice_start = k.start if k.start else 0
            slice_stop = k.stop
            slice_step = k.step if k.step else 1
            
            new_start = self._kth_value(slice_start)
            new_stop = self._kth_value(slice_stop)
            new_step = self.step * slice_step
            
            return FloatRange(new_start, new_stop, new_step)
            
        raise TypeError(&quot;Индексация возможна только целым числом или срезом&quot;)

r = FloatRange(0, 3, 0.5)

print(f&quot;{r}[1:5:2]-&gt;{r[1:5:2]}&quot;)
print(f&quot;{r}[5:1:-1]-&gt;{r[5:1:-1]}&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>range(0, 3, 0.5)[1:5:2]-&gt;range(0.5, 2.5, 1.0)
range(0, 3, 0.5)[5:1:-1]-&gt;range(2.5, 0.5, -0.5)
</pre></div>
</div>
</div>
</div>
<p>Метод <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> дополнился новым блоком кода.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
    <span class="n">slice_start</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">start</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">start</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">slice_stop</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">stop</span>
    <span class="n">slice_step</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">step</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">step</span> <span class="k">else</span> <span class="mi">1</span>
    
    <span class="n">new_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kth_value</span><span class="p">(</span><span class="n">slice_start</span><span class="p">)</span>
    <span class="n">new_stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kth_value</span><span class="p">(</span><span class="n">slice_stop</span><span class="p">)</span>
    <span class="n">new_step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">*</span> <span class="n">slice_step</span>
    
    <span class="k">return</span> <span class="n">FloatRange</span><span class="p">(</span><span class="n">new_start</span><span class="p">,</span> <span class="n">new_stop</span><span class="p">,</span> <span class="n">new_step</span><span class="p">)</span>
</pre></div>
</div>
<p>Параметры <code class="docutils literal notranslate"><span class="pre">start</span></code> и <code class="docutils literal notranslate"><span class="pre">step</span></code> среза по умолчанию приравниваются к <code class="docutils literal notranslate"><span class="pre">None</span></code>. Первые три строки извлекают эти параметры и обрабатывают возможный <code class="docutils literal notranslate"><span class="pre">None</span></code>. Следующие три строки вычисляют границы и шаг нового диапазона, который и возвращается в качестве результата.</p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks\python"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="polymorphism.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Полиморфизм в python</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="exercises2.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Практические задания</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Fadeev Egor<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>