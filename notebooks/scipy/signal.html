
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Обработка сигналов &#8212; Практикум по компьютерным технологиям</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/my_css_rules.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Пользовательские классы" href="../python/custom_classes.html" />
    <link rel="prev" title="Решение нелинейных уравнений" href="nonlinear_equations.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-EM33EZ6FLL"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-EM33EZ6FLL');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Практикум по компьютерным технологиям</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../docs/index.html">
                    Практикум по компьютерным технологиям на языке программирования python3
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №1
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../python/about_python.html">
   О
   <code class="docutils literal notranslate">
    <span class="pre">
     python
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../docs/getting_started.html">
   Установка
   <code class="docutils literal notranslate">
    <span class="pre">
     python
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../docs/python_as_calculator.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     Python
    </span>
   </code>
   в качестве калькулятора
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../docs/scripts.html">
   Скрипты
   <code class="docutils literal notranslate">
    <span class="pre">
     python
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/jupyter.html">
   Блокноты.
   <code class="docutils literal notranslate">
    <span class="pre">
     Jupyter
    </span>
    <span class="pre">
     Notebooks
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/numbers_and_lists.html">
   Основные типы объектов: числа и списки
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/if_for_range.html">
   Операторы потока управления
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../homework/1.html">
   Домашнее задание №1
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №2
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../docs/interpretability.html">
   Компилируемость vs Интерпретируемость
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/dynamic_typing.html">
   Динамическая типизация
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/type_annotations.html">
   Аннотация типов
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/mutability.html">
   Изменяемые и неизменяемый типы объектов
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/garbage_collector.html">
   Создание и удаление объектов. Сборщик мусора
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/sequences.html">
   Последовательности: списки, кортежи и строки
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../homework/2.html">
   Домашнее задание №2
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №3
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../docs/libs_pypi_conda.html">
   Сторонние библиотеки и пакетные менеджеры
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/numpy.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     NumPy
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/vectorization.html">
   Векторизация
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/slices.html">
   Срезы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/vector_product.html">
   Умножение векторов
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/logic.html">
   Логические операции
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/vectorization_example.html">
   Векторизация на примере вычисления статистик
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/random.html">
   Случайные числа
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../numpy/homework.html">
   Домашнее задание №3
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №4
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../python/dictionaries.html">
   Словари.
   <code class="docutils literal notranslate">
    <span class="pre">
     dict
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/functions.html">
   Функции
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/filesystem.html">
   Взаимодействие с файловой системой
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/files.html">
   Работа с файлами. Сериализация:
   <code class="docutils literal notranslate">
    <span class="pre">
     json
    </span>
   </code>
   и
   <code class="docutils literal notranslate">
    <span class="pre">
     pickle
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../visualization/libraries.html">
   Построение графиков и визуализация данных
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../visualization/matplotlib.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     Matplotlib
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../visualization/details.html">
   Настройка деталей графиков
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../visualization/matplotlib_animation.html">
   Анимация  в matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../visualization/homework.html">
   Домашнее задание №4
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №5
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/tables.html">
   Таблицы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/pandas.html">
   Библиотека
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/series.html">
   Столбцы в
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/dataframe.html">
   Таблицы
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/operations.html">
   Оперирование таблицами
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/datetime.html">
   Дата и время
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/covid19.html">
   Анализ данных о
   <code class="docutils literal notranslate">
    <span class="pre">
     COVID19
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pandas/homework.html">
   Домашнее задание №5
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №6
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../python/list_comprehensions.html">
   Основы списковых включений
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/iterators.html">
   Итераторы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/generators.html">
   Генераторы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/decorators.html">
   Декораторы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../homework/6.html">
   Домашнее задание №6
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №7
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="scipy.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     SciPy
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linalg.html">
   Линейная алгебра
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="interpolation_approx.html">
   Интерполяция и аппроксимация
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="integration.html">
   Дифференцирование и интегрирование функций
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ODE.html">
   Решение ОДУ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optimization.html">
   Поиск минимума
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nonlinear_equations.html">
   Решение нелинейных уравнений
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Обработка сигналов
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №8
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../python/custom_classes.html">
   Пользовательские классы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/inheritance.html">
   Наследование
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/polymorphism.html">
   Полиморфизм в python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/operators_overloading.html">
   Перегрузка специальных методов и операторов
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/exercises2.html">
   Практические задания
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №9
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../python/exceptions.html">
   Исключения
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/custom_exceptions.html">
   Пользовательские исключения
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/LBYL_vs_EAFP.html">
   Стратегии контроля ошибок
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Лекция №10
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/gui.html">
   Графический пользовательский интерфейс
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/basics.html">
   PySide. Основы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/event.html">
   События
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/slot_signal.html">
   Слоты и сигналы
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/widgets.html">
   Виджеты и макеты
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/buttons.html">
   Кнопки
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/output.html">
   Вывод данных
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/input.html">
   Ввод данных
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/dialogs.html">
   Диалоговые окна
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qt/exercises.html">
   Практические задания
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  TBD
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../python/about_12_and_so_on.html">
   О последних лекциях
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../computer_vision/basics.html">
   Работа с изображениями
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../computer_vision/filters.html">
   Свёрточные операции
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../computer_vision/detection.html">
   Задача обнаружения
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../machine_learning/regression.html">
   Регрессия
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../machine_learning/classification.html">
   Классификация
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../machine_learning/neural_networks.html">
   Нейронный сети
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/python_scripts.html">
   Создание скриптов. Работа с IDE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/scripts_vs_modules.html">
   Скрипты и модули
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python/argparse.html">
   Аргументы командной строки
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/FadeevLecturer/python_lectures/main?urlpath=tree/notebooks/scipy/signal.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/FadeevLecturer/python_lectures/blob/main/notebooks/scipy/signal.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/FadeevLecturer/python_lectures"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/FadeevLecturer/python_lectures/issues/new?title=Issue%20on%20page%20%2Fnotebooks/scipy/signal.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/FadeevLecturer/python_lectures/edit/main/notebooks/scipy/signal.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/notebooks/scipy/signal.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   О сигналах
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   Дискретное преобразование Фурье
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Определение
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Базис Фурье
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scipy-fft">
     Быстрое преобразование Фурье.
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.fft
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     Физический смысл
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     Пример Фурье анализа
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       Цикл солнечной активности
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       Музыкальные инструменты
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     Фильтрация низких частот
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id11">
   Свертка и взаимокорреляция
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     Скользящее среднее
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vs">
     Свертка
     <code class="docutils literal notranslate">
      <span class="pre">
       vs
      </span>
     </code>
     взаимокорреляция
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       Свёртка
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id14">
       Взаимокорреляция
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scipy-signal">
     Реализация в
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.signal
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#valid">
       Режим
       <code class="docutils literal notranslate">
        <span class="pre">
         valid
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#same">
       Режим
       <code class="docutils literal notranslate">
        <span class="pre">
         same
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#full">
       Режим
       <code class="docutils literal notranslate">
        <span class="pre">
         full
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id15">
     Взаимная корреляция для локализации шаблона
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     Теорема о свёртке
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Обработка сигналов</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   О сигналах
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   Дискретное преобразование Фурье
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Определение
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Базис Фурье
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scipy-fft">
     Быстрое преобразование Фурье.
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.fft
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     Физический смысл
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     Пример Фурье анализа
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       Цикл солнечной активности
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       Музыкальные инструменты
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     Фильтрация низких частот
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id11">
   Свертка и взаимокорреляция
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     Скользящее среднее
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vs">
     Свертка
     <code class="docutils literal notranslate">
      <span class="pre">
       vs
      </span>
     </code>
     взаимокорреляция
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       Свёртка
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id14">
       Взаимокорреляция
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scipy-signal">
     Реализация в
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.signal
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#valid">
       Режим
       <code class="docutils literal notranslate">
        <span class="pre">
         valid
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#same">
       Режим
       <code class="docutils literal notranslate">
        <span class="pre">
         same
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#full">
       Режим
       <code class="docutils literal notranslate">
        <span class="pre">
         full
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id15">
     Взаимная корреляция для локализации шаблона
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     Теорема о свёртке
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>Обработка сигналов<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>На данной странице под спойлерами находятся ячейки с кодом, реализующим пользовательский интерфейс на основе средств <a class="reference external" href="https://ipywidgets.readthedocs.io/en/stable/"> jupyter widgets</a>. На момент написания материалов графический интерфейс не встраивается на сайт при генерации <code class="docutils literal notranslate"><span class="pre">html</span></code> файлов, так что может потребоваться открытие исходный блокнотов <code class="docutils literal notranslate"><span class="pre">jupyter</span></code>, например, в <code class="docutils literal notranslate"><span class="pre">google</span> <span class="pre">colab</span></code> (кнопка сверху).</p>
</div>
<section id="id2">
<h2>О сигналах<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<p>В рамках данной страницы под сигналом <span class="math notranslate nohighlight">\(x\)</span> будет подразумеваться последовательность чисел <span class="math notranslate nohighlight">\(x[n], \, n=0,\ldots,N-1\)</span>, где <span class="math notranslate nohighlight">\(N\)</span> — длинна сигнала, а <span class="math notranslate nohighlight">\(x[n]\in\mathbb{R}\)</span> — значение сигнала в дискретной временной точке <span class="math notranslate nohighlight">\(n\)</span>.</p>
</section>
<section id="id3">
<h2>Дискретное преобразование Фурье<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h2>
<section id="id4">
<h3>Определение<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<p>Пусть имеется сигнал <span class="math notranslate nohighlight">\(x[n], \,n=0,\ldots,N-1\)</span> длинной <span class="math notranslate nohighlight">\(N\)</span>. Тогда результат прямымого дискретного преобразования фурье (ДПФ, Discrete Fourier Transform, DPF) определяется выражением</p>
<div class="math notranslate nohighlight">
\[
X[k] = \sum_{n=0}^{N-1} x[n] e^{-\tfrac{2\pi i}{N}kn}, \, k=0,\ldots,N-1,
\]</div>
<p>где <span class="math notranslate nohighlight">\(X[k]\)</span> — результат прямого дискретного преобразования Фурье, <span class="math notranslate nohighlight">\(i\)</span> — мнимая единица. Прямое преобразование Фурье обратимо и обратное дискретное преобразование Фурье определяется выражением</p>
<div class="math notranslate nohighlight">
\[
x[n] = \dfrac1N \sum_{k=0} X[k] e^{\tfrac{2\pi i}{N}kn}, \, k=0,\ldots,N-1.
\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>В литературе чаще всего стречается именное такое определение преобразований Фурье, когда перед обратным преобразованием Фурье ставится множитель <span class="math notranslate nohighlight">\(\dfrac1N\)</span>, и именно такое определение заложенно во все методы библиотеки <code class="docutils literal notranslate"><span class="pre">scipy</span></code>. Однако иногда можно встретить и другие нормироваки такого преобразования.</p>
</div>
</section>
<section id="id5">
<h3>Базис Фурье<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<p>Дискретное преобразование Фурье линейное и по сути дела является разложением по Фурье базису, элементы которого являются комплексными синусоидами</p>
<div class="math notranslate nohighlight">
\[
\omega_k[n] = e^{\tfrac{2\pi i}{N}kn} = \cos\left(\dfrac{2\pi}{N}kn\right) + i\sin\left(\dfrac{2\pi}{N}kn\right), \, k=0,\ldots,N-1.
\]</div>
<p>С учетом этого факта прямое преобразование Фурье можно записать в матричном виде</p>
<div class="math notranslate nohighlight">
\[
X = \mathcal{F}x,
\]</div>
<p>где матрица перехода <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> имеет вид.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathcal{F} = \begin{pmatrix}
1 &amp; 1 &amp; 1 &amp; 1 &amp; \cdots &amp; 1 \\
1 &amp; \omega &amp; \omega^2 &amp; \omega^3 &amp; \cdots &amp; \omega^{N-1} \\
1 &amp; \omega^2 &amp; \omega^4 &amp; \omega^6 &amp; \cdots &amp; \omega^{2(N-1)} \\
1 &amp; \omega^3 &amp; \omega^6 &amp; \omega^9 &amp; \cdots &amp; \omega^{3(N-1)} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
1 &amp; \omega^{N-1} &amp; \omega^{2(N-1)} &amp; \omega^{3(N-1)} &amp; \cdots &amp; \omega^{(N-1)^2}
\end{pmatrix}, \quad \omega = e^{\tfrac{2\pi i}{N}}.
\end{split}\]</div>
<p>Столбцы этой матрицы и являются элементами Фурье базиса. Сгенерировать такую матрицу заданного размера можно методом <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.dft.html">scipy.linalg.dft</a>. В ячейке ниже определяется функция <code class="docutils literal notranslate"><span class="pre">plot_basis_vector</span></code> для визуализации базисных векторов Фурье, а под ней прокидывается интерактивный интерфейс к этой функции.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">dft</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>


<span class="k">def</span> <span class="nf">plot_basis_vector</span><span class="p">(</span><span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span> 
    <span class="n">basis_vector</span> <span class="o">=</span> <span class="n">dft</span><span class="p">(</span><span class="n">length</span><span class="p">)[:,</span> <span class="n">index</span><span class="p">]</span>
    <span class="n">real</span><span class="p">,</span> <span class="n">imag</span> <span class="o">=</span> <span class="n">basis_vector</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">basis_vector</span><span class="o">.</span><span class="n">imag</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">real</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Re$\omega_k[n]$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">imag</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Im$\omega_k[n]$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$n$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">plot_basis_vector</span><span class="p">,</span>
    <span class="n">length</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">fixed</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
    <span class="n">index</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "8ca6cbde39444356bb4d2ce43a253864", "version_major": 2, "version_minor": 0}
</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function __main__.plot_basis_vector(length: int, index: int)&gt;
</pre></div>
</div>
</div>
</div>
<p>Отсюда видно, что элементы базиса Фурье — синусоиды и косинусоиды разной кратности (гармоники), помещающиеся целое число раз на отрезке <span class="math notranslate nohighlight">\([0, \ldots, N-1]\)</span>. Базис Фурье является ортогональным, но не является ортонормированным.</p>
</section>
<section id="scipy-fft">
<h3>Быстрое преобразование Фурье. <code class="docutils literal notranslate"><span class="pre">scipy.fft</span></code><a class="headerlink" href="#scipy-fft" title="Permalink to this headline">#</a></h3>
<p>Итак, результатом прямого преобразования Фурье сигнала <span class="math notranslate nohighlight">\(x\)</span> является последовательность комплексных чисел <span class="math notranslate nohighlight">\(X[k]\)</span>, которые являются коэффициентами разложения сигнала <span class="math notranslate nohighlight">\(x\)</span> по гармоникам. В модуле <code class="docutils literal notranslate"><span class="pre">scipy.fft</span></code> определенно множество функций для Фурье-анализа сигналов. Аббревиатура <strong>FFT</strong> происходит из <strong>F</strong>ast <strong>F</strong>ourier <strong>T</strong>transform — <a class="reference external" href="https://ru.wikipedia.org/wiki/%D0%91%D1%8B%D1%81%D1%82%D1%80%D0%BE%D0%B5_%D0%BF%D1%80%D0%B5%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%A4%D1%83%D1%80%D1%8C%D0%B5">быстрое преобразование Фурье</a> (<strong>БПФ</strong>) — алгоритм ускоренного вычисления дискретного преобразования Фурье. За прямое и обратное быстрое преобразование сигнала произвольной природы (возможно комплексного) отвечают функции <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fft.fft.html#scipy.fft.fft">fft</a> и <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fft.ifft.html#scipy.fft.ifft">ifft</a>, возвращающие комплекснозначный <code class="docutils literal notranslate"><span class="pre">numpy</span></code> массив всех коэффициентов.</p>
<p>При этом можно показать, что если исходный сигнал <span class="math notranslate nohighlight">\(x\)</span> действительнозначный, то</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
\mathop{\mathrm{Re}} X[k] =  \mathop{\mathrm{Re}} X[N-k], &amp; k=1,\ldots,\left\lfloor\dfrac{N}{2}\right\rfloor, \\
\mathop{\mathrm{Im}} X[k] = -\mathop{\mathrm{Im}} X[N-k], &amp; k=1,\ldots,\left\lfloor\dfrac{N}{2}\right\rfloor.
\end{cases}
\end{split}\]</div>
<p>Иными словами половину коэффициентов Фурье действительнозначного сигнала можно отбросить. Функция <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fft.rfft.html#scipy.fft.rfft">rfft</a> делает именно это: она возвращает только половину необходимых коэффициентов Фурье, а функция <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fft.irfft.html#scipy.fft.irfft">irfft</a> осуществляет обратное преобразование Фурье, исходя из предположения, что ей на вход подаётся только половина коэффициентов Фурье, а оставшееся половина восстанавливается из поданных по формулам выше.</p>
</section>
<section id="id6">
<h3>Физический смысл<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h3>
<p>Модуль <span class="math notranslate nohighlight">\(|X[k]|\)</span> и аргумент <span class="math notranslate nohighlight">\(\angle X[k]\)</span> коэффициента разложения Фурье называют <strong>амплитудой</strong> и <strong>фазой</strong> <span class="math notranslate nohighlight">\(k\)</span>-й гармоники. Амплитуда гармоники определяет степень её присутствия в исходном сигнале, а фаза — сдвиг этой гармоники по времени.</p>
<p>Проще всего продемонстрировать смысл коэффициентов разложения Фурье, если сигнал изначально представляет собой линейную комбинацию гармоник. В ячейке ниже определяется функция <code class="docutils literal notranslate"><span class="pre">plot_sinusoid_fft</span></code>, визуализирующая Фурье-анализ сигнала вида</p>
<div class="math notranslate nohighlight">
\[
x[n] = A_1\cos(\dfrac{2\pi}{N}\omega_1(n - b_1)) + A_2\cos(\dfrac{2\pi}{N}\omega_2(n - b_3)) + A_3\cos(\dfrac{2\pi}{N}\omega_3(n - b_3)).
\]</div>
<p>В скрытой ячейке ещё ниже прокидывается графический интерфейс, для интерактивного взаимодействия с функцией для визуализации. Подвигав ползунки создайте сигнал из одной гармоники (<span class="math notranslate nohighlight">\(A_1=1\)</span>), и изучите как изменяется спектральное представление сигнала при изменении частоты гармоники (<span class="math notranslate nohighlight">\(\omega_1\)</span>) и (<span class="math notranslate nohighlight">\(b_1\)</span>). Для наглядности рекомендуется использовать метод <code class="docutils literal notranslate"><span class="pre">rfft</span></code> (флажок <code class="docutils literal notranslate"><span class="pre">real</span> <span class="pre">signal</span></code>) и полярное представления (флажок <code class="docutils literal notranslate"><span class="pre">polar</span></code>). Флажок <code class="docutils literal notranslate"><span class="pre">prevent</span> <span class="pre">phase</span> <span class="pre">artifacts</span></code> предотвращает загрязнение графики с фазами, связанное с неустойчивостью вычислений угла комплексного числа при его близости к нулю.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">rfft</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>

<span class="k">def</span> <span class="nf">plot_sinusoid_fft</span><span class="p">(</span>
    <span class="n">real_signal</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">polar</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">mask_zeros</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">A1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">A2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">A3</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">omega1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">omega2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">omega3</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
    <span class="n">b1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">b2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">b3</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">):</span> 
    <span class="n">c</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">signal</span> <span class="o">=</span> <span class="n">A1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">omega1</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">b1</span><span class="p">))</span> <span class="o">+</span> <span class="n">A2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">omega2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">b2</span><span class="p">))</span> <span class="o">+</span> <span class="n">A3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">omega3</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">b3</span><span class="p">))</span>
    
    <span class="n">transform_function</span> <span class="o">=</span> <span class="n">rfft</span> <span class="k">if</span> <span class="n">real_signal</span> <span class="k">else</span> <span class="n">fft</span>
    <span class="n">fourier</span> <span class="o">=</span> <span class="n">transform_function</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
    <span class="n">real</span><span class="p">,</span> <span class="n">imag</span> <span class="o">=</span> <span class="n">fourier</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">fourier</span><span class="o">.</span><span class="n">imag</span>
    <span class="n">magnitude</span><span class="p">,</span> <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fourier</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">fourier</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mask_zeros</span><span class="p">:</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">magnitude</span> <span class="o">&gt;</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    
    <span class="n">ax1</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">magnitude</span> <span class="k">if</span> <span class="n">polar</span> <span class="k">else</span> <span class="n">real</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">phase</span> <span class="k">if</span> <span class="n">polar</span> <span class="k">else</span> <span class="n">imag</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$k$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x[k]$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$|X[k]|$&quot;</span> <span class="k">if</span> <span class="n">polar</span> <span class="k">else</span> <span class="s2">&quot;Re $X[k]$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\angle X[k]$&quot;</span> <span class="k">if</span> <span class="n">polar</span> <span class="k">else</span> <span class="s2">&quot;Im $X[k]$&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">polar</span><span class="p">:</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">widgets</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">64</span>

<span class="n">real_signal</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Checkbox</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;real signal&quot;</span><span class="p">)</span>
<span class="n">polar</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Checkbox</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span><span class="p">)</span>
<span class="n">mask_zeros</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Checkbox</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;prevent phase artifacts&quot;</span><span class="p">)</span>
<span class="n">A1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;$A_1$&quot;</span><span class="p">)</span>
<span class="n">A2</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;$A_2$&quot;</span><span class="p">)</span>
<span class="n">A3</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;$A_3$&quot;</span><span class="p">)</span>
<span class="n">omega1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;$\omega_1$&quot;</span><span class="p">)</span>
<span class="n">omega2</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;$\omega_2$&quot;</span><span class="p">)</span>
<span class="n">omega3</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;$\omega_3$&quot;</span><span class="p">)</span>
<span class="n">b1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;$b_1$&quot;</span><span class="p">)</span>
<span class="n">b2</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;$b_2$&quot;</span><span class="p">)</span>
<span class="n">b3</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;$b_3$&quot;</span><span class="p">)</span>

<span class="n">ui</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span>
    <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">real_signal</span><span class="p">,</span> <span class="n">polar</span><span class="p">,</span> <span class="n">mask_zeros</span><span class="p">]),</span>
    <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">A1</span><span class="p">,</span> <span class="n">omega1</span><span class="p">,</span> <span class="n">b1</span><span class="p">]),</span>
    <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">A2</span><span class="p">,</span> <span class="n">omega2</span><span class="p">,</span> <span class="n">b2</span><span class="p">]),</span>
    <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">A3</span><span class="p">,</span> <span class="n">omega3</span><span class="p">,</span> <span class="n">b3</span><span class="p">]),</span>
<span class="p">])</span>

<span class="n">variables</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;real_signal&quot;</span><span class="p">,</span> <span class="s2">&quot;polar&quot;</span><span class="p">,</span> <span class="s2">&quot;mask_zeros&quot;</span><span class="p">,</span> <span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="s2">&quot;A3&quot;</span><span class="p">,</span> <span class="s2">&quot;omega1&quot;</span><span class="p">,</span> <span class="s2">&quot;omega2&quot;</span><span class="p">,</span> <span class="s2">&quot;omega3&quot;</span><span class="p">,</span> <span class="s2">&quot;b1&quot;</span><span class="p">,</span> <span class="s2">&quot;b2&quot;</span><span class="p">,</span> <span class="s2">&quot;b3&quot;</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interactive_output</span><span class="p">(</span>
    <span class="n">plot_sinusoid_fft</span><span class="p">,</span>
    <span class="p">{</span><span class="n">varname</span><span class="p">:</span> <span class="nb">globals</span><span class="p">()[</span><span class="n">varname</span><span class="p">]</span> <span class="k">for</span> <span class="n">varname</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">}</span>
<span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">ui</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "04720de89e724c9381dd6735c6aad72e", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "1be9a156a22c49b1bb6de7e1cdcf3ee9", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</section>
<section id="id7">
<h3>Пример Фурье анализа<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h3>
<section id="id8">
<h4>Цикл солнечной активности<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h4>
<p>Рассмотрим уже знакомый вам график солнечной активности.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">fftfreq</span>

<span class="n">folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;assets&quot;</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span> <span class="o">/</span> <span class="s2">&quot;signals&quot;</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">/</span> <span class="s2">&quot;solar_activiry.npy&quot;</span>
<span class="n">year</span><span class="p">,</span> <span class="n">activity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">activity</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Solar activity by year&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;activity&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;activity&#39;)
</pre></div>
</div>
<img alt="../../_images/signal_8_1.png" src="../../_images/signal_8_1.png" />
</div>
</div>
<p>На графике в глаза бросается некоторая сезонность: попробуем определить её период. Для этого вычислим преобразование Фурье и построим график, но по горизонтальное оси отложим не частоту, а период. Так как частота — количество полных колебаний за измеренный диапазон, то период <span class="math notranslate nohighlight">\(T\)</span> соответствующей синусоиды с частотой <span class="math notranslate nohighlight">\(\omega\)</span> можно найти по формуле</p>
<div class="math notranslate nohighlight">
\[
T =  \dfrac{\text{number of years}}{\omega}.
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fourier</span> <span class="o">=</span> <span class="n">rfft</span><span class="p">(</span><span class="n">activity</span><span class="p">)</span>
<span class="n">magnitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fourier</span><span class="p">)</span>
<span class="n">years_span</span> <span class="o">=</span> <span class="n">year</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">year</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">frequency</span> <span class="o">=</span> <span class="n">years_span</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">fourier</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">magnitudes</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;period [years]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;magnitude&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;11 years&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x25c65ccd510&gt;
</pre></div>
</div>
<img alt="../../_images/signal_10_1.png" src="../../_images/signal_10_1.png" />
</div>
</div>
<p>На полученном графике в глаза бросается период в 11 лет, что согласуется с данными из <a class="reference external" href="https://ru.wikipedia.org/wiki/%D0%A1%D0%BE%D0%BB%D0%BD%D0%B5%D1%87%D0%BD%D0%B0%D1%8F_%D1%86%D0%B8%D0%BA%D0%BB%D0%B8%D1%87%D0%BD%D0%BE%D1%81%D1%82%D1%8C">википедии</a>.</p>
</section>
<section id="id9">
<h4>Музыкальные инструменты<a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h4>
<p>На сайте <a class="reference external" href="https://www.ee.columbia.edu/~dpwe/sounds/instruments/">колумбийского университета</a> можно найти короткие записи отдельных нот сыгранных разными инструментами в формате <a class="reference external" href="https://en.wikipedia.org/wiki/WAV">WAV</a>. Человеческий слух может отличить один инструмент от другого без особых проблем. Построим графики этих записей для ноты <strong>до</strong> и посмотрим, насколько легко отличить инструменты друг от друга визуально.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Для чтения аудиозаписей в формате WAV подходит метод <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.io.wavfile.read.html">scipy.io.wavfile.read</a>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">wavfile</span>

<span class="n">instruments</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;piano&quot;</span><span class="p">,</span> <span class="s2">&quot;violin&quot;</span><span class="p">,</span> <span class="s2">&quot;trumpet&quot;</span><span class="p">,</span> <span class="s2">&quot;flute&quot;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">plot_audio_wave</span><span class="p">(</span><span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">instrument</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">instrument</span><span class="si">}</span><span class="s2">-C4.wav&quot;</span>
    <span class="n">sample_rate</span><span class="p">,</span> <span class="n">audio_wave</span> <span class="o">=</span> <span class="n">wavfile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">audio_length</span> <span class="o">=</span> <span class="n">audio_wave</span><span class="o">.</span><span class="n">size</span> <span class="o">/</span> <span class="n">sample_rate</span>
    <span class="n">timestamps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">audio_length</span><span class="p">,</span> <span class="n">audio_wave</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span> <span class="n">audio_wave</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time [s]&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;level&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">instrument</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">instrument</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">instruments</span><span class="p">):</span>
    <span class="n">plot_audio_wave</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">instrument</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/signal_12_0.png" src="../../_images/signal_12_0.png" />
</div>
</div>
<p>Построенные графики не так уж легко анализировать. Гораздо проще будет анализировать их в частотном спектре. Внизу определяется функция, которая строит частотный спектр и выводит аудиоплеер с записью, а в скрытой ячейке ещё ниже к этой функции прокидывается графический интерфейс.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">music_spectral_analysis</span><span class="p">(</span><span class="n">instrument</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tone</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fundamental_tone</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">folder</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">instrument</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">tone</span><span class="si">}</span><span class="s1">.wav&#39;</span>
    <span class="n">sample_rate</span><span class="p">,</span> <span class="n">audio_wave</span> <span class="o">=</span> <span class="n">wavfile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    
    <span class="n">fourier</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">audio_wave</span><span class="p">)</span>
    <span class="n">magnitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fourier</span><span class="p">)</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">fftfreq</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">audio_wave</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">sample_rate</span><span class="p">)</span>
    <span class="n">max_frequency</span> <span class="o">=</span> <span class="mi">2_000</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">magnitudes</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_frequency</span><span class="p">,</span> <span class="n">fundamental_tone</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">1e7</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_frequency</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;frequency [Hz]&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;level&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">instrument</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">tone</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="n">audio_player</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Audio</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">autoplay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">audio_player</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">music_spectral_analysis</span><span class="p">,</span>
    <span class="n">instrument</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">ToggleButtons</span><span class="p">(</span>
        <span class="n">options</span><span class="o">=</span><span class="n">instruments</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Instrument&quot;</span>
    <span class="p">),</span>
    <span class="n">tone</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">ToggleButtons</span><span class="p">(</span>
        <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;C4&quot;</span><span class="p">,</span> <span class="s2">&quot;G4&quot;</span><span class="p">,</span> <span class="s2">&quot;C5&quot;</span><span class="p">],</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Tone&quot;</span>
    <span class="p">),</span>
    <span class="n">fundamental_tone</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">fixed</span><span class="p">(</span><span class="mf">261.63</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "9bf870a887424ff082cf5d37d8f722d7", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<p>На построенных графиках видно, что звук распределяется по определенным частотам спектра. Самая низкая из таких частот называется <a class="reference external" href="https://ru.wikipedia.org/wiki/%D0%9E%D1%81%D0%BD%D0%BE%D0%B2%D0%BD%D0%BE%D0%B9_%D1%82%D0%BE%D0%BD">тоном</a>, и именно он определяет высоту звука. Так, например, ноте <strong>до</strong> из четвертый октавы соответствует частота 261.63 Гц (<a class="reference external" href="https://pages.mtu.edu/~suits/notefreqs.html">источник</a>). Остальные, кратные основному тону, частоты называют — <a class="reference external" href="https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B5%D1%80%D1%82%D0%BE%D0%BD">обертонами</a>. Распределение звука по обертонам называют <a class="reference external" href="https://ru.wikipedia.org/wiki/%D0%A2%D0%B5%D0%BC%D0%B1%D1%80">тембром</a>, и именно по тембр меняется в зависимости от инструмента, на котором сыграна нота.</p>
</section>
</section>
<section id="id10">
<h3>Фильтрация низких частот<a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h3>
<p>ДПФ можно использовать для фильтрации определенных частот в сигнале. Распространенный пример — <a class="reference external" href="https://ru.wikipedia.org/wiki/%D0%A4%D0%B8%D0%BB%D1%8C%D1%82%D1%80_%D0%BD%D0%B8%D0%B6%D0%BD%D0%B8%D1%85_%D1%87%D0%B0%D1%81%D1%82%D0%BE%D1%82">фильтр нижних частот</a>, который эффективно пропускает частотный спектр сигнала ниже некоторой частоты (частоты среза) и подавляет частоты сигнала выше этой частоты. Такого рода фильтрация иногда применяется в том числе и для фильтрации шумов: несущий информацию сигнал попадает в низкочастотную область, а помехи дают вклад на высоких частотах.</p>
<p>Для реализации такого фильтра в дискретном случае достаточно проделать следующие шаги.</p>
<ol class="simple">
<li><p>Совершить прямое дискретное преобразование Фурье;</p></li>
<li><p>Занулить все коэффициенты получившегося разложения, которые соответствуют частотам выше заданной;</p></li>
<li><p>Совершить обратное дискретное преобразование Фурье для разложения с зануленными коэффициентами.</p></li>
</ol>
<p>В ячейке ниже определяется функция <code class="docutils literal notranslate"><span class="pre">plot_fourier_filter</span></code>, визуализирующая действие такого фильтра на зашумленный сигнал в зависимости от пороговой частоты. В скрытой ячейке ещё ниже прокидывается графический интерфейс, для интерактивного взаимодействия с этой функцией. Регулируя положение ползунка, отвечающего за пороговую частоту фильтрации, можно попробовать восстановить исходный сигнал.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">rfft</span><span class="p">,</span> <span class="n">irfft</span>

<span class="k">def</span> <span class="nf">plot_fourier_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">noisy_signal</span><span class="p">,</span> <span class="n">treshold_frequency</span><span class="p">):</span>
    <span class="n">fourier</span> <span class="o">=</span> <span class="n">rfft</span><span class="p">(</span><span class="n">noisy_signal</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">fourier</span><span class="o">.</span><span class="n">size</span>
    <span class="n">low_freq</span> <span class="o">=</span> <span class="n">irfft</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">&gt;</span><span class="n">treshold_frequency</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fourier</span><span class="p">))</span>
    <span class="n">high_freq</span> <span class="o">=</span> <span class="n">irfft</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">&gt;</span><span class="n">treshold_frequency</span><span class="p">,</span> <span class="n">fourier</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Исходный сигнал&quot;</span><span class="p">,</span> <span class="s2">&quot;Исходный сигнал + шум&quot;</span><span class="p">,</span> <span class="s2">&quot;Низкие частоты&quot;</span><span class="p">,</span> <span class="s2">&quot;Высокие частоты&quot;</span><span class="p">]</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">signal</span><span class="p">,</span> <span class="n">noisy_signal</span><span class="p">,</span> <span class="n">low_freq</span><span class="p">,</span> <span class="n">high_freq</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">ys</span><span class="p">,</span> <span class="n">titles</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$k$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">folder</span> <span class="o">/</span> <span class="s2">&quot;triangle.npy&quot;</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">size</span>
<span class="n">noisy_signal</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">plot_fourier_filter</span><span class="p">,</span>
    <span class="n">signal</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">fixed</span><span class="p">(</span><span class="n">signal</span><span class="p">),</span>
    <span class="n">noisy_signal</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">fixed</span><span class="p">(</span><span class="n">noisy_signal</span><span class="p">),</span>
    <span class="n">treshold_frequency</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "780c6d46bb754c1bba0b40d984b5bb99", "version_major": 2, "version_minor": 0}
</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function __main__.plot_fourier_filter(signal, noisy_signal, treshold_frequency)&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id11">
<h2>Свертка и взаимокорреляция<a class="headerlink" href="#id11" title="Permalink to this headline">#</a></h2>
<section id="id12">
<h3>Скользящее среднее<a class="headerlink" href="#id12" title="Permalink to this headline">#</a></h3>
<p>Идея скользящего среднего очень хорошо иллюстрируется в названии операции: окно фиксированной ширины скользит вдоль по массиву и усредняет все попавшие в него значения.</p>
<figure class="align-default">
<img alt="../../_images/moving_average.gif" src="../../_images/moving_average.gif" />
</figure>
<p>Пусть <span class="math notranslate nohighlight">\(x[i], \, i=0,\ldots,n-1\)</span> — исходный сигнал, тогда результат скользящего среднего <span class="math notranslate nohighlight">\(y\)</span> с окном шириной <span class="math notranslate nohighlight">\(m\)</span> определяется выражением</p>
<div class="math notranslate nohighlight">
\[
y[j] = \dfrac{1}{m}\sum_{i=0}^{m - 1} x[i + j], \quad j=0,\ldots,n-m.
\]</div>
<p>Анимация ниже иллюстрирует эту формулу при длине исходного сигнала <span class="math notranslate nohighlight">\(n=5\)</span> и ширине окна скользящего окна <span class="math notranslate nohighlight">\(m=3\)</span>.</p>
<figure class="align-default">
<img alt="../../_images/moving_average_discrete.gif" src="../../_images/moving_average_discrete.gif" />
</figure>
<p>Представим теперь операцию усреднения внутри окна в виде операции взвешенной суммы с коэффициентами <span class="math notranslate nohighlight">\(\dfrac{1}{m}\)</span>:</p>
<div class="math notranslate nohighlight">
\[
y[j] = \sum_{i=0}^{m - 1} x[i + j] \cdot \dfrac{1}{m}, \quad j=0,\ldots,n-m.
\]</div>
<figure class="align-default">
<img alt="../../_images/moving_average_convolve.gif" src="../../_images/moving_average_convolve.gif" />
</figure>
</section>
<section id="vs">
<h3>Свертка <code class="docutils literal notranslate"><span class="pre">vs</span></code> взаимокорреляция<a class="headerlink" href="#vs" title="Permalink to this headline">#</a></h3>
<section id="id13">
<h4>Свёртка<a class="headerlink" href="#id13" title="Permalink to this headline">#</a></h4>
<p>Такую операцию можно рассмотреть в качестве частного случая <strong>свертки</strong> (англ. <code class="docutils literal notranslate"><span class="pre">convolution</span></code>), которая получится, если значения <span class="math notranslate nohighlight">\(\dfrac{1}{m}\)</span> заменить на набор произвольных коэффициентов <span class="math notranslate nohighlight">\(\omega = \{\omega[i], \, i=1,\ldots,m-1\}\)</span> следующим образом</p>
<div class="math notranslate nohighlight">
\[
y[j] = \sum_{i=0}^{m - 1} x[i + j]\cdot\omega[m - i - 1], \quad j=0,\ldots,n-m.
\]</div>
<figure class="align-default">
<img alt="../../_images/convolution.gif" src="../../_images/convolution.gif" />
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Обратите внимание, что в скользящем окне коэффициенты <span class="math notranslate nohighlight">\(\omega[i], \, i=1,\ldots,m-1\)</span> заполнены в обратном порядке.</p>
</div>
<p>Набор коэффициентов <span class="math notranslate nohighlight">\(\omega[i], \, i=1,\ldots,m-1\)</span> называют <strong>ядром</strong> (англ. <code class="docutils literal notranslate"><span class="pre">kernel</span></code>). Пусть <span class="math notranslate nohighlight">\(x\)</span> — исходный сигнал, <span class="math notranslate nohighlight">\(\omega\)</span> — ядро свертки, тогда результат действия <span class="math notranslate nohighlight">\(y\)</span> свертки с ядром <span class="math notranslate nohighlight">\(\omega\)</span> на сигнал <span class="math notranslate nohighlight">\(x\)</span> будем обозначать <span class="math notranslate nohighlight">\(y = x\circledast \omega\)</span>.</p>
</section>
<section id="id14">
<h4>Взаимокорреляция<a class="headerlink" href="#id14" title="Permalink to this headline">#</a></h4>
<p>Если же в скользящем окне заполнить коэффициенты <span class="math notranslate nohighlight">\(\omega[i], \, i=1,\ldots,m-1\)</span> в прямом порядке, то получится операция, которую называют <strong>взаимокорреляцией</strong> (англ. <code class="docutils literal notranslate"><span class="pre">convolution</span></code>). В данном случае речь обычно идёт о взаимной корреляции двух сигналов, хотя в определенных можно встретить термин “ядро” и по отношению к <span class="math notranslate nohighlight">\(\omega\)</span> тоже.</p>
<div class="math notranslate nohighlight">
\[
y[j] = \sum_{i=0}^{m - 1} x[i + j]\cdot\omega[i], \quad j=0,\ldots,n-m.
\]</div>
<figure class="align-default">
<img alt="../../_images/cross_correlation.gif" src="../../_images/cross_correlation.gif" />
</figure>
</section>
</section>
<section id="scipy-signal">
<h3>Реализация в <code class="docutils literal notranslate"><span class="pre">scipy.signal</span></code><a class="headerlink" href="#scipy-signal" title="Permalink to this headline">#</a></h3>
<p>Вычислить взаимокорреляцию двух сигналов можно методом <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.correlate.html#scipy.signal.correlate">signal.correlate</a>, а свёртку методом <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.convolve.html#scipy.signal.convolve">signal.convolve</a>. Оба метода в качестве первых двух параметров принимают два массива, которые представляют два сигнала или сигнал и ядро свёртки.</p>
<p>Однако у обоих методов есть опциональный параметр <code class="docutils literal notranslate"><span class="pre">mode</span></code>, который отвечает за итоговый размер получившегося массива. Он может принимать один из трех возможных значений: <code class="docutils literal notranslate"><span class="pre">same</span></code>, <code class="docutils literal notranslate"><span class="pre">valid</span></code> или <code class="docutils literal notranslate"><span class="pre">full</span></code>.</p>
<section id="valid">
<h4>Режим <code class="docutils literal notranslate"><span class="pre">valid</span></code><a class="headerlink" href="#valid" title="Permalink to this headline">#</a></h4>
<p>В режиме <code class="docutils literal notranslate"><span class="pre">valid</span></code> окно с ядром скользит только в тех пределах, где ядро полностью накладывается на исходных сигнал.</p>
<figure class="align-default">
<img alt="../../_images/valid.gif" src="../../_images/valid.gif" />
</figure>
<p>Итоговая длина сигнала получается <span class="math notranslate nohighlight">\(n - m + 1\)</span>, где <span class="math notranslate nohighlight">\(n\)</span> — длина исходного сигнала, а <span class="math notranslate nohighlight">\(m\)</span> — размер ядра.</p>
</section>
<section id="same">
<h4>Режим <code class="docutils literal notranslate"><span class="pre">same</span></code><a class="headerlink" href="#same" title="Permalink to this headline">#</a></h4>
<p>В режиме <code class="docutils literal notranslate"><span class="pre">same</span></code> исходный сигнал <span class="math notranslate nohighlight">\(x\)</span> дополняется необходимым количеством нулей с правой стороны (это количество равно <span class="math notranslate nohighlight">\(m-1\)</span>, если <span class="math notranslate nohighlight">\(m\)</span> — размер ядра), чтобы итоговый сигнал имел такую же длину.</p>
<figure class="align-default">
<img alt="../../_images/same.gif" src="../../_images/same.gif" />
</figure>
</section>
<section id="full">
<h4>Режим <code class="docutils literal notranslate"><span class="pre">full</span></code><a class="headerlink" href="#full" title="Permalink to this headline">#</a></h4>
<p>В режиме <code class="docutils literal notranslate"><span class="pre">full</span></code> окно с ядром скользит в пределах, где ядро накладывается на исходный сигнал хотя бы одним элементом. Для этого приходится дополнять исходный массив с обеих сторон <span class="math notranslate nohighlight">\(m - 1\)</span> нулями.</p>
<figure class="align-default">
<img alt="../../_images/full.gif" src="../../_images/full.gif" />
</figure>
<p>Итоговая длина сигнала получается <span class="math notranslate nohighlight">\(n + m - 1\)</span>, где <span class="math notranslate nohighlight">\(n\)</span> — длина исходного сигнала, а <span class="math notranslate nohighlight">\(m\)</span> — размер ядра.</p>
</section>
</section>
<section id="id15">
<h3>Взаимная корреляция для локализации шаблона<a class="headerlink" href="#id15" title="Permalink to this headline">#</a></h3>
<p>Операция вычисления взаимной корреляции сигнала <span class="math notranslate nohighlight">\(x\)</span> с шаблонным сигналом <span class="math notranslate nohighlight">\(y\)</span> может быть использована для локализации шаблона внутри этой последовательности, т.к. значение корреляции совпадает с мерой схожести <a class="reference external" href="https://en.wikipedia.org/wiki/Cosine_similarity">cosine similarity</a> для векторов <span class="math notranslate nohighlight">\(A\)</span> и <span class="math notranslate nohighlight">\(B\)</span></p>
<div class="math notranslate nohighlight">
\[
\cos\theta = \dfrac{A \cdot B}{\|A\|\|B\|}\in{[-1, 1]}. 
\]</div>
<p>Массив взаимной корреляции совпадает с числителем этой дроби для всех положений шаблона <span class="math notranslate nohighlight">\(y\)</span> внутри сигнала <span class="math notranslate nohighlight">\(x\)</span>, если принять, что <span class="math notranslate nohighlight">\(x=A\)</span> и <span class="math notranslate nohighlight">\(y=B\)</span>. Чтобы вычислить меру схожести для каждого из положений шаблона внутри сигнала, остаётся только поделить массив взаимной корреляции на соответствующие нормы. Норма массива <span class="math notranslate nohighlight">\(y\)</span> постоянна, а вот норма части массива <span class="math notranslate nohighlight">\(x\)</span>, попавшей под шаблон меняется, и для её вычисления требуется произвести оконную операцию.</p>
<p>Внизу приводится функция <code class="docutils literal notranslate"><span class="pre">rolling_cosine_similarity</span></code>, вычисляющая косинусную меру схожести описанным выше способом, и функция <code class="docutils literal notranslate"><span class="pre">locate_template</span></code>, визуализирующая способ локализации шаблона на основе такого подхода.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">correlate</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">numpy.lib.stride_tricks</span> <span class="kn">import</span> <span class="n">sliding_window_view</span>


<span class="k">def</span> <span class="nf">rolling_cosine_similarity</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">):</span>
    <span class="n">template_norm</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
    <span class="n">signal_norm</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">sliding_window_view</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">template</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">correlate</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;valid&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">signal_norm</span> <span class="o">*</span> <span class="n">template_norm</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>
     
     
<span class="k">def</span> <span class="nf">locate_template</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">shift</span><span class="p">):</span>
    <span class="n">template_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">+</span> <span class="n">shift</span>
    <span class="n">cross_correlation</span> <span class="o">=</span> <span class="n">rolling_cosine_similarity</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">template</span><span class="p">)</span>
    <span class="n">correlation</span> <span class="o">=</span> <span class="n">cross_correlation</span><span class="p">[</span><span class="n">shift</span><span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;signal&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">template_x</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;template&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$k$&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cross_correlation</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;lag&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;correlation&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">shift</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">correlation</span><span class="si">=:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">shift</span><span class="p">,</span> <span class="n">correlation</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">folder</span> <span class="o">/</span> <span class="s2">&quot;template.npy&quot;</span><span class="p">)</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">folder</span> <span class="o">/</span> <span class="s2">&quot;triangle_step.npy&quot;</span><span class="p">)</span>
<span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">locate_template</span><span class="p">,</span>
    <span class="n">signal</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">fixed</span><span class="p">(</span><span class="n">signal</span><span class="p">),</span>
    <span class="n">template</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">fixed</span><span class="p">(</span><span class="n">template</span><span class="p">),</span>
    <span class="n">shift</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="n">template</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "89e1050871d247d69e435859a655e513", "version_major": 2, "version_minor": 0}
</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function __main__.locate_template(signal, template, shift)&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="id16">
<h3>Теорема о свёртке<a class="headerlink" href="#id16" title="Permalink to this headline">#</a></h3>
<p>Несмотря на то, что взаимная корреляция может показаться более естественной операцией, математики больше любят именно свёртку. Основная причина этому — свойства свёртки, например, теорема о свёртке.</p>
<p><strong>Теорема о свёртке.</strong> Пусть <span class="math notranslate nohighlight">\(\mathcal{F}(x)\)</span> и <span class="math notranslate nohighlight">\(\mathcal{F}(y)\)</span> — Фурье образы сигналов одинаковой длины <span class="math notranslate nohighlight">\(x\)</span> и <span class="math notranslate nohighlight">\(y\)</span>. Тогда справедливо равенство</p>
<div class="math notranslate nohighlight">
\[
\mathcal{F}(x \circledast y) = \mathcal{F}(x) \cdot \mathcal{F}(y),
\]</div>
<p>где операция “<span class="math notranslate nohighlight">\(\cdot\)</span>” — операция поэлементного умножения массивов.</p>
<p>Продемонстрируем это свойство на примере вычисления скользящего среднего. Скользящее среднее шириной <span class="math notranslate nohighlight">\(m\)</span> можно представить в качестве свёртки с ядром <span class="math notranslate nohighlight">\(\omega_i = \dfrac{1}{m}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">folder</span> <span class="o">/</span> <span class="s2">&quot;triangle_step.npy&quot;</span><span class="p">)</span>
<span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">30</span>
<span class="nb">filter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="nb">filter</span><span class="p">[:</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">m</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Сигнал&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">filter</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Ядро скользящего среднего&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$k$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x25c778a2470&gt;
</pre></div>
</div>
<img alt="../../_images/signal_23_1.png" src="../../_images/signal_23_1.png" />
</div>
</div>
<p>Теперь вычислим результат свёртки с этим ядром в явном виде и опираясь на теорему о свёртке, а затем сравним результаты.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">convolve</span>

<span class="n">fourier_signal</span> <span class="o">=</span> <span class="n">rfft</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
<span class="n">fourier_filter</span> <span class="o">=</span> <span class="n">rfft</span><span class="p">(</span><span class="nb">filter</span><span class="p">)</span>
<span class="n">convolution_theorem</span> <span class="o">=</span> <span class="n">irfft</span><span class="p">(</span><span class="n">fourier_signal</span> <span class="o">*</span> <span class="n">fourier_filter</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">signal</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="n">straightforward</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="nb">filter</span><span class="p">,</span> <span class="s2">&quot;full&quot;</span><span class="p">)[:</span><span class="n">signal</span><span class="o">.</span><span class="n">size</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">straightforward</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Свёртка&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">convolution_theorem</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Теорема о свёртке&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$k$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x25c7ccff910&gt;
</pre></div>
</div>
<img alt="../../_images/signal_25_1.png" src="../../_images/signal_25_1.png" />
</div>
</div>
<p>Как видим результаты совпадают. Это позволяет быстро вычислять свертку для длинных сигналов: библиотека <code class="docutils literal notranslate"><span class="pre">scipy</span></code> тоже использует такой трюк.
Кроме того это позволяет анализировать, что делают те или иные фильтры.</p>
<p>Например, ячейка ниже демонстрирует, что скользящее среднее можно считать (неидеальным) фильтром нижних частот.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">rfft</span><span class="p">,</span> <span class="n">irfft</span>

<span class="k">def</span> <span class="nf">visualize_step_filter</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="nb">filter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="nb">filter</span><span class="p">[:</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">m</span>

    <span class="n">fourier_signal</span> <span class="o">=</span> <span class="n">rfft</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
    <span class="n">fourier_filter</span> <span class="o">=</span> <span class="n">rfft</span><span class="p">(</span><span class="nb">filter</span><span class="p">)</span>
    <span class="n">filtered_signal</span> <span class="o">=</span> <span class="n">irfft</span><span class="p">(</span><span class="n">fourier_signal</span> <span class="o">*</span> <span class="n">fourier_filter</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">signal</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">filtered_signal</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Сглаженный сигнал&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$k$&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fourier_filter</span><span class="p">))</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;frequency&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;magnitude&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">folder</span> <span class="o">/</span> <span class="s2">&quot;triangle_step.npy&quot;</span><span class="p">)</span>
<span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">visualize_step_filter</span><span class="p">,</span>
    <span class="n">signal</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">fixed</span><span class="p">(</span><span class="n">signal</span><span class="p">),</span>
    <span class="n">m</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "f451fbc35c2141e7a920770b5213cc7a", "version_major": 2, "version_minor": 0}
</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function __main__.visualize_step_filter(signal, m: int)&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks\scipy"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="nonlinear_equations.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Решение нелинейных уравнений</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../python/custom_classes.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Пользовательские классы</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Fadeev Egor<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>